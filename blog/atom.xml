<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://moonrepo.dev/blog</id>
    <title>moon Blog</title>
    <updated>2022-10-06T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://moonrepo.dev/blog"/>
    <subtitle>moon Blog</subtitle>
    <icon>https://moonrepo.dev/img/favicon.svg</icon>
    <entry>
        <title type="html"><![CDATA[v0.16 - Per-project tool versions and TypeScript impovements]]></title>
        <id>v0.16</id>
        <link href="https://moonrepo.dev/blog/v0.16"/>
        <updated>2022-10-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we've landed a long standing request of supporting project-level overrides for]]></summary>
        <content type="html"><![CDATA[<p>With this release, we've landed a long standing request of supporting project-level overrides for
tools configured in the workspace, as well as some quality of life improvements for TypeScript.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="per-project-tool-version-overrides">Per-project tool version overrides<a class="hash-link" href="#per-project-tool-version-overrides" title="Direct link to heading">​</a></h2><p>Since moons inception, our <a href="/docs/concepts/toolchain">toolchain</a> has only supported a single
version of a tool (Node.js), as we wanted to embrace the single version policy and encourage all
consumers to keep their tooling version consistent across all projects for reliability. While this
works flawlessly, it's not entirely realistic, as many companies have legacy projects that are stuck
on older versions for whatever reason, and integrating them into moon was rather difficult.</p><p>Well no more! We've refactored our toolchain to support tool overrides on a project-by-project
basis. Since we only support Node.js at the moment, this can be achieved with the new
<a href="/docs/config/project#node"><code>workspace.node.version</code></a> setting in
<a href="/docs/config/project"><code>moon.yml</code></a>.</p><p>For example, if your workspace Node.js version is configured as v18.</p><div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">.moon/workspace.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">node</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'18.0.0'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can now override this version at the project-level. Let's go with v14.</p><div class="language-yml codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/moon.yml</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-yml codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token key atrule">workspace</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token key atrule">node</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token key atrule">version</span><span class="token punctuation" style="color:#cad4e2">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'14.0.0'</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When running a task from a project with overrides, the toolchain will download, install, and
configure the new version behind the scenes. This new version will then be used to install
dependencies and execute the tasks commands.</p><blockquote><p>Although we now support overriding the tool version, the workspace configured package manager
(<code>node.packageManager</code>) and associated version cannot be overridden. This is unlikely to change.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_JmGV" id="per-project-dependency-installs">Per-project dependency installs<a class="hash-link" href="#per-project-dependency-installs" title="Direct link to heading">​</a></h2><p>Because of the toolchain refactor above, we now support per-project dependency installs as a welcome
side-effect. This is a necessary step in supporting new languages, especially for those that don't
install dependencies in the workspace for all projects, and must install them per project.</p><p>This also means that moon now supports non-<code>package.json</code> workspaces! If your repository <em>is not</em>
using npm/pnpm/yarn workspaces, or a project <em>is not</em> listed within the workspaces glob list,
dependencies will be installed within the project.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="typescript-improvements">TypeScript improvements<a class="hash-link" href="#typescript-improvements" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_JmGV" id="routing-outdir-to-the-cache">Routing <code>outDir</code> to the cache<a class="hash-link" href="#routing-outdir-to-the-cache" title="Direct link to heading">​</a></h3><p>A requirement for using project references is that each project must compile declarations (<code>.d.ts</code>)
so that consumers/dependees can resolve type information. While this makes sense, it becomes rather
unfortunate as each project folder is now littered with the declaration outputs, which are typically
gitignored.</p><p>To improve this experience, we're introducing a new setting
<a href="/docs/config/workspace#routeoutdirtocache"><code>typescript.routeOutDirToCache</code></a>, that will update the
<code>outDir</code> compiler option of <em>all</em> projects to route to moon's cache directory (which should already
be gitignored). This will standardize the use of project references for the entire repository.</p><p>For example, a project at "packages/components" will route to the following output directory:</p><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/tsconfig.json</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token comment" style="color:#97a1af;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"compilerOptions"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"outDir"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../../.moon/cache/types/packages/components"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>If you require declarations to live within the project, for example an npm package that ships
types, you should introduce an additional configuration to handle this, like
<code>tsconfig.build.json</code>.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_JmGV" id="mapping-project-references-as-paths">Mapping project references as <code>paths</code><a class="hash-link" href="#mapping-project-references-as-paths" title="Direct link to heading">​</a></h3><p>moon automatically keeps TypeScript project references in sync with the
<a href="/docs/config/workspace#syncprojectreferences"><code>typescript.syncProjectReferences</code></a> setting, which
is great, but we can take it further. With the new
<a href="/docs/config/workspace#syncprojectreferencestopaths"><code>typescript.syncProjectReferencesToPaths</code></a>
setting, project references (either synced or explicitly defined) will <em>also</em> be mapped to the
<code>paths</code> compiler option, automating the list of import aliases.</p><p>For example, if a reference has the package name <code>@brand/components</code>, the <code>paths</code> will be mapped
with:</p><div class="language-json codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">&lt;project&gt;/tsconfig.json</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-json codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token comment" style="color:#97a1af;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"compilerOptions"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token comment" style="color:#97a1af;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token property" style="color:#b7a9f9">"paths"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"@brand/components"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"../shared/components/src/index.ts"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"@brand/components/*"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token string" style="color:#c9e166">"../shared/components/src/*"</span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token punctuation" style="color:#cad4e2">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token property" style="color:#b7a9f9">"references"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">      </span><span class="token property" style="color:#b7a9f9">"path"</span><span class="token operator" style="color:#b7a9f9">:</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">"../shared/components"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">  </span><span class="token punctuation" style="color:#cad4e2">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token punctuation" style="color:#cad4e2">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" href="#other-changes" title="Direct link to heading">​</a></h2><p>View the
<a href="https://github.com/moonrepo/moon/releases/tag/%40moonrepo%2Fcli%400.16.0" target="_blank" rel="noopener noreferrer">official release</a> for a
full list of changes.</p><ul><li>Template files can now be suffixed with <code>.tera</code> or <code>.twig</code> for
<a href="/docs/guides/codegen#file-extensions">syntax highlighting</a>.</li><li>We now display more commands and information when running tasks.</li><li>Declare implicit task dependencies with a new
<a href="/docs/config/workspace.mdx#implicitdeps"><code>runner.implicitDeps</code></a> setting.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>Expect the following in the v0.17 release!</p><ul><li>Webhooks for important pipeline events (for real this time)!</li><li>YAML anchors and references in config files.</li><li>And <a href="https://github.com/moonrepo/moon/issues/356" target="_blank" rel="noopener noreferrer">many more</a>...</li></ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="toolchain" term="toolchain"/>
        <category label="runner" term="runner"/>
        <category label="generator" term="generator"/>
        <category label="typescript" term="typescript"/>
        <category label="node" term="node"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[v0.15 - Enhanced Docker support and 1,000 stars!]]></title>
        <id>v0.15</id>
        <link href="https://moonrepo.dev/blog/v0.15"/>
        <updated>2022-09-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we've focused heavily on Docker integration and enhancing the Dockerfile]]></summary>
        <content type="html"><![CDATA[<p>With this release, we've focused heavily on Docker integration and enhancing the <code>Dockerfile</code>
workflow, as well as some minor quality of life improvements for template files and run reports.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="1000-️️">1,000 ⭐️🌟⭐️!<a class="hash-link" href="#1000-️️" title="Direct link to heading">​</a></h2><p>Before we dive into the release, we want to thank everyone for the initial support, as we passed
<a href="https://github.com/moonrepo/moon" target="_blank" rel="noopener noreferrer">1,000 stars on GitHub</a> earlier this week! moon was announced back
in June, and to reach this milestone in roughly 3 months is very exciting. We greatly appreciate the
support, and to everyone that is using moon and providing feedback, we thank you from the bottom of
our hearts!</p><p>We have a very long roadmap ahead of us, but are very excited to bring all of these features to you,
and to improve the overall developer experience for your monorepos! Here's to 10,000 stars!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="first-class-docker-support">First-class Docker support<a class="hash-link" href="#first-class-docker-support" title="Direct link to heading">​</a></h2><p><a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">Docker</a> is a very popular tool that is typically a part of a developers
workflow, but is also a very tedious one, as <code>Dockerfile</code>s have to be manually curated for every
project. We aim to mitigate this problem by supporting Docker as a first-class feature, and by
introducing 2 new commands, <a href="/docs/commands/docker/scaffold"><code>moon docker scaffold</code></a> and
<a href="/docs/commands/docker/prune"><code>moon docker prune</code></a>.</p><p>These commands will automate a <code>Dockerfile</code> as much as possible to effectively take advantage of
Docker's layer caching, multi-staged builds, to reduce the amount of manual <code>COPY</code> commands, to
reduce the overall size of the container or image, and much more. To demonstrate this, compare the
before and after <code>Dockerfile</code>s below!</p><div class="tabs-container tabList_J5MA"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_l0OV tabs__item--active">Before</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">After</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_wHwb"><div class="language-docker codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-docker codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> node:latest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install moon binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> npm install -g @moonrepo/cli</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy moon files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./.moon ./.moon</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy all package.json's and lockfiles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/cli/package.json ./packages/cli/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-linux-arm64-gnu/package.json ./packages/core-linux-arm64-gnu/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-linux-arm64-musl/package.json ./packages/core-linux-arm64-musl/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-linux-x64-gnu/package.json ./packages/core-linux-x64-gnu/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-linux-x64-musl/package.json ./packages/core-linux-x64-musl/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-macos-arm64/package.json ./packages/core-macos-arm64/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-macos-x64/package.json ./packages/core-macos-x64/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/core-windows-x64-msvc/package.json ./packages/core-windows-x64-msvc/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/runtime/package.json ./packages/runtime/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/types/package.json ./packages/types/package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./package.json ./package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./yarn.lock ./yarn.lock</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./.yarn ./.yarn</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./.yarnrc.yml ./yarnrc.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install toolchain and dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy project and required files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/types ./packages/types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> ./packages/runtime ./packages/runtime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># COPY . .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Build the target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon run runtime:build</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_wHwb" hidden=""><div class="language-docker codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-docker codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic">#### BASE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> node:latest </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> base</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install moon binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> npm install -g @moonrepo/cli</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### WORKSPACE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> base </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> workspace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy entire repository and scaffold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> . .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon docker scaffold runtime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic">#### BUILD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">FROM</span><span class="token instruction"> base </span><span class="token instruction keyword" style="color:#b7a9f9">AS</span><span class="token instruction"> build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy workspace skeleton</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">workspace</span><span class="token instruction"> /app/.moon/docker/workspace .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Install toolchain and dependencies</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Copy source files</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">COPY</span><span class="token instruction"> </span><span class="token instruction options property" style="color:#b7a9f9">--from</span><span class="token instruction options punctuation" style="color:#cad4e2">=</span><span class="token instruction options string" style="color:#c9e166">workspace</span><span class="token instruction"> /app/.moon/docker/sources .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Build the target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon run runtime:build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Prune workspace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token instruction keyword" style="color:#b7a9f9">RUN</span><span class="token instruction"> moon docker prune</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><blockquote><p>View the official <a href="/docs/guides/docker">Docker usage guide</a> for an in-depth walkthrough of all
these new features!</p></blockquote><h2 class="anchor anchorWithStickyNavbar_JmGV" id="frontmatter-for-template-files">Frontmatter for template files<a class="hash-link" href="#frontmatter-for-template-files" title="Direct link to heading">​</a></h2><p>We released <a href="/blog/v0.14">templates and the generator in v0.14</a> for quick and easy code generation.
Since it was the initial release, it provided the bare minimum of features for common workflows.
We'll continually improve this system over each release, and have done just that for this release,
as all template files now support <a href="/docs/guides/codegen#frontmatter">frontmatter</a>! Frontmatter is
a mechanism for declaring <em>per-file configuration</em>, and is denoted by <code>---</code> delimiters at the top of
the file.</p><p>This allows you to do some really cool stuff, like overriding the destination path of the file using
the <code>to</code> field, as well as taking full advantage of Tera's filters and conditional rendering!</p><div class="language-twig codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockTitle_x_ju">templates/react/components/base.tsx</div><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-twig codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">{%</span><span class="token twig language-twig"> </span><span class="token twig language-twig tag-name keyword" style="color:#b7a9f9">set</span><span class="token twig language-twig"> component_name </span><span class="token twig language-twig operator" style="color:#b7a9f9">=</span><span class="token twig language-twig"> name </span><span class="token twig language-twig operator" style="color:#b7a9f9">|</span><span class="token twig language-twig"> pascal_case </span><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">%}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">---</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">to: components/</span><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">{{</span><span class="token twig language-twig"> component_name </span><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">}}</span><span class="token plain">.tsx</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">---</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">export function </span><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">{{</span><span class="token twig language-twig"> component_name </span><span class="token twig language-twig delimiter punctuation" style="color:#cad4e2">}}</span><span class="token plain">() {</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">    return </span><span class="token tag punctuation" style="color:#cad4e2">&lt;</span><span class="token tag" style="color:#b7a9f9">div</span><span class="token tag" style="color:#b7a9f9"> </span><span class="token tag punctuation" style="color:#cad4e2">/&gt;</span><span class="token plain">;</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" href="#other-changes" title="Direct link to heading">​</a></h2><p>View the
<a href="https://github.com/moonrepo/moon/releases/tag/%40moonrepo%2Fcli%400.15.0" target="_blank" rel="noopener noreferrer">official release</a> for a
full list of changes.</p><ul><li>Run reports (via <code>--report</code>) now include additional information, like the total duration, and
estimated time savings.<ul><li>The <a href="https://github.com/marketplace/actions/moon-ci-run-reports" target="_blank" rel="noopener noreferrer">moonrepo/run-report-action</a> has
been updated with this information.</li></ul></li><li>Improved pnpm integration for Go/Rust binaries shipped in node modules.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>Expect the following in the v0.16 release!</p><ul><li>Quality of life improvements for TypeScript.</li><li>Per-project overrides for language/tool versions.</li></ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="generator" term="generator"/>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[v0.14 - Code generation and implicit dependencies]]></title>
        <id>v0.14</id>
        <link href="https://moonrepo.dev/blog/v0.14"/>
        <updated>2022-09-13T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we've landed some new features that have been requested multiple times since]]></summary>
        <content type="html"><![CDATA[<p>With this release, we've landed some new features that have been requested multiple times since
launch. A code generation and template scaffolding layer, as well as implicit dependency scanning
for the project graph!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-moon-generate-command">New <code>moon generate</code> command<a class="hash-link" href="#new-moon-generate-command" title="Direct link to heading">​</a></h2><p>Code generation is the staple of any large company or repository. Want to spin up a new application?
What about an npm package? Or maybe third-party integrations? Avoid copy-and-pasting existing code,
and instead generate it with the new <code>moon generate</code> command, which is powered by our new generator
system.</p><p>The generator will locate a template by name on the file system ("npm-package" in the example
below), prompt and interpolate variables, render the files with <a href="https://tera.netlify.app/" target="_blank" rel="noopener noreferrer">Tera</a> (a
Rust based template engine), and write the files to the target destination.</p><div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Generate code from a template to a target directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon generate npm-package ./packages/example</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Learn more about <a href="/docs/guides/codegen">code generation in the official guide</a>!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="implicit-dependency-scanning">Implicit dependency scanning<a class="hash-link" href="#implicit-dependency-scanning" title="Direct link to heading">​</a></h2><p>This has been a request since moon's official release, and it's finally here! Up until now, if you
wanted project-to-project dependency relationships, you had to explicitly declare them with
<a href="/docs/config/project#dependson"><code>dependsOn</code></a>. But thanks to a
<a href="https://github.com/moonrepo/moon/pull/288" target="_blank" rel="noopener noreferrer">ton of</a>
<a href="https://github.com/moonrepo/moon/pull/249" target="_blank" rel="noopener noreferrer">infrastructure</a> and
<a href="https://github.com/moonrepo/moon/pull/277" target="_blank" rel="noopener noreferrer">platform</a> changes, we can now infer implicit
dependencies automatically!</p><p>We still suggest using explicit dependencies, as it provides more
<a href="/docs/concepts/project#dependencies">automation like project syncing</a>, but implicit is great for
adoption and migration purposes.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="report-ci-runs-on-pull-requests">Report CI runs on pull requests<a class="hash-link" href="#report-ci-runs-on-pull-requests" title="Direct link to heading">​</a></h2><p>We're fans of continuous and easily accessible feedback, and as such, have released a new GitHub
action, <a href="https://github.com/marketplace/actions/moon-ci-run-reports" target="_blank" rel="noopener noreferrer"><code>moonrepo/run-report-action</code></a>,
which reports the results of <a href="/docs/commands/ci"><code>moon ci</code></a> as a pull request comment. The report
looks something like the following:</p><div style="padding-bottom:1rem;padding-top:1rem;text-align:center"><img src="/assets/images/run-report-41cffa17cd530ab8cca5cef47b38dcfd.png" width="60%" alt=""></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" href="#other-changes" title="Direct link to heading">​</a></h2><p>View the
<a href="https://github.com/moonrepo/moon/releases/tag/%40moonrepo%2Fcli%400.14.0" target="_blank" rel="noopener noreferrer">official release</a> for a
full list of changes.</p><ul><li>When running in a Docker container, caching is disabled in an effort to greatly reduce the size of
the image.</li><li>Updated <code>moon setup</code> to also install Node.js dependencies.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>Expect the following in the v0.15 release!</p><ul><li>Major Docker workflow improvements!</li><li>Frontmatter configuration within template files.</li></ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="generator" term="generator"/>
        <category label="project-graph" term="project-graph"/>
        <category label="ci" term="ci"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[v0.13 - Hashing and toolchain improvements]]></title>
        <id>v0.13</id>
        <link href="https://moonrepo.dev/blog/v0.13"/>
        <updated>2022-09-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[With this release, we've landed some improvements to our smart hashing, and paved the road for]]></summary>
        <content type="html"><![CDATA[<p>With this release, we've landed some improvements to our smart hashing, and paved the road for
additional languagues and tooling.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="nodejs-is-now-optional">Node.js is now optional<a class="hash-link" href="#nodejs-is-now-optional" title="Direct link to heading">​</a></h2><p>Title may seem confusing at first, but don't worry, everything is fine! For some context, moon has
been designed to be language agnostic as we plan to support more than JavaScript in the future.
However, some aspects of the codebase were hard-coded for JavaScript and made the assumption that
JavaScript will always be used, with one such aspect being the
<a href="/docs/config/workspace#node"><code>node</code></a> setting in
<a href="/docs/config/workspace"><code>.moon/workspace.yml</code></a>.</p><p>We've reworked this setting to be optional, which allows a repository to opt out of JavaScript.
Right now, this basically does nothing as we do not support other languages yet, but we felt it
necessary to report it anyways! A side-effect of this change is that actions in the runner have been
renamed, for example, <code>SetupToolchain</code> -&gt; <code>SetupNodeToolchain</code>.</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="improved-hashing-accuracy">Improved hashing accuracy<a class="hash-link" href="#improved-hashing-accuracy" title="Direct link to heading">​</a></h2><p>Our <a href="/docs/concepts/cache#hashing">smart hashing layer</a> is pretty powerful, but was not entirely
accurate. Up until now, when hashing a Node.js project, we'd include the <code>dependencies</code>,
<code>devDependencies</code>, and <code>peerDependencies</code> versions located within the project's <code>package.json</code> as
hash inputs. This was great, because if a dependency was explicitly upgraded in the <code>package.json</code>,
it would invalidate the previous hashes as the version number changed.</p><p>However, what if the dependency was implicitly upgraded by another project, but the <code>package.json</code>
was not modified? These kind of transitive changes were currently ignored by moon, but no longer, as
moon will now resolve all <code>package.json</code> dependencies to the resolved version found in the root
lockfile (<code>package-lock.json</code>, <code>yarn.lock</code>, etc)!</p><p>At moon, we believe in providing consumers with the ability to configure to their needs, and as
such, have added a new <a href="/docs/config/workspace#hasher"><code>hasher</code></a> setting to
<a href="/docs/config/workspace"><code>.moon/workspace.yml</code></a>. This setting will allow you to choose between the
2 hashing patterns above!</p><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-moon-check-command">New <code>moon check</code> command<a class="hash-link" href="#new-moon-check-command" title="Direct link to heading">​</a></h2><p>If you're like us, you're constantly testing, linting, typechecking, so on and so forth, a project
while developing. This was rather cumbersome, as you either had to use separate run commands
(<code>moon run project:test</code>, <code>moon run project:lint</code>, etc), or use the multi-run approach
(<code>moon run project:test project:lint</code>). Both approaches were not ideal for rapid development.</p><p>To simplify this process, we've added a new <a href="/docs/commands/check"><code>moon check</code></a> command, that
will automatically run <em>all</em> build and test tasks for a project (or many projects)! Local and non-CI
tasks will <em>not</em> be ran.</p><div class="language-shell codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token comment" style="color:#97a1af;font-style:italic"># Check project at current working directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Check project by name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check app</span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain"></span><span class="token comment" style="color:#97a1af;font-style:italic"># Check multiple projects by name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#e5e9f1"><span class="token plain">$ moon check client server</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="new-moonrepotypes-package">New <code>@moonrepo/types</code> package<a class="hash-link" href="#new-moonrepotypes-package" title="Direct link to heading">​</a></h2><p>We have many ideas for moon specific npm packages that we plan to release, but before we do that, we
need to ensure all of them are built with the correct interfaces. To solve this, we are shipping a
new package, <a href="https://www.npmjs.com/package/@moonrepo/types" target="_blank" rel="noopener noreferrer">@moonrepo/types</a>, that simply publishes
TypeScript declarations. It contains everything from project and task shapes, configuration
structures, runner information, and more.</p><div class="language-ts codeBlockContainer_mQmQ theme-code-block" style="--prism-background-color:#00080f;--prism-color:#e5e9f1"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-ts codeBlock_RMoD thin-scrollbar"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#e5e9f1"><span class="token keyword" style="color:#b7a9f9">import</span><span class="token plain"> </span><span class="token keyword" style="color:#b7a9f9">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#cad4e2">{</span><span class="token plain"> ProjectConfig </span><span class="token punctuation" style="color:#cad4e2">}</span><span class="token plain"> </span><span class="token keyword" style="color:#b7a9f9">from</span><span class="token plain"> </span><span class="token string" style="color:#c9e166">'@moonrepo/types'</span><span class="token punctuation" style="color:#cad4e2">;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg class="copyButtonIcon_FoOz" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_L0B6" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_JmGV" id="other-changes">Other changes<a class="hash-link" href="#other-changes" title="Direct link to heading">​</a></h2><p>View the
<a href="https://github.com/moonrepo/moon/releases/tag/%40moonrepo%2Fcli%400.13.0" target="_blank" rel="noopener noreferrer">official release</a> for a
full list of changes.</p><ul><li>The runner will now fail with an error if a task has defined <code>outputs</code> but an output was not
created after the task is executed. This change was made so that artifacts are deterministic.</li><li>The <code>actionRunner</code> setting in <a href="/docs/config/workspace"><code>.moon/workspace.yml</code></a> was renamed to
<code>runner</code>.</li></ul><h2 class="anchor anchorWithStickyNavbar_JmGV" id="whats-next">What's next?<a class="hash-link" href="#whats-next" title="Direct link to heading">​</a></h2><p>Expect the following in the v0.14 release!</p><ul><li>A <code>moon generate</code> command to generate new projects, files, scaffolding, and more from pre-defined
templates.</li><li>Implicit dependency discovery. moon will now scan manifest files and determine project
relationships.</li></ul>]]></content>
        <author>
            <name>Miles Johnson</name>
            <uri>https://github.com/milesj</uri>
        </author>
        <category label="hasher" term="hasher"/>
        <category label="toolchain" term="toolchain"/>
    </entry>
</feed>