"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2778],{39798:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(27378),r=n(38944);const i="tabItem_wHwb";function o(e){let{children:t,hidden:n,className:o}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(i,o),hidden:n},t)}},33337:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(25773),r=n(27378),i=n(38944),o=n(83457),l=n(35595),s=n(76457);const u="tabList_J5MA",p="tabItem_l0OV";function c(e){let{className:t,block:n,selectedValue:l,selectValue:s,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.o5)(),g=e=>{const t=e.currentTarget,n=c.indexOf(t),a=u[n].value;a!==l&&(d(t),s(a))},m=e=>{let t=null;switch(e.key){case"Enter":g(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:o}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:g},o,{className:(0,i.Z)("tabs__item",p,o?.className,{"tabs__item--active":l===t})}),n??t)})))}function d(e){let{lazy:t,children:n,selectedValue:a}=e;if(n=Array.isArray(n)?n:[n],t){const e=n.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function g(e){const t=(0,l.Y)(e);return r.createElement("div",{className:(0,i.Z)("tabs-container",u)},r.createElement(c,(0,a.Z)({},e,t)),r.createElement(d,(0,a.Z)({},e,t)))}function m(e){const t=(0,s.Z)();return r.createElement(g,(0,a.Z)({key:String(t)},e))}},35595:(e,t,n)=>{n.d(t,{Y:()=>d});var a=n(27378),r=n(35331),i=n(30654),o=n(70784),l=n(71819);function s(e){return function(e){return a.Children.map(e,(e=>{if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function u(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??s(n);return function(e){const t=(0,o.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function c(e){let{queryString:t=!1,groupId:n}=e;const o=(0,r.k6)(),l=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,i._X)(l),(0,a.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(o.location.search);t.set(l,e),o.replace({...o.location,search:t.toString()})}),[l,o])]}function d(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,i=u(e),[o,s]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:i}))),[d,g]=c({queryString:n,groupId:r}),[m,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,i]=(0,l.Nk)(n);return[r,(0,a.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:r}),h=(()=>{const e=d??m;return p({value:e,tabValues:i})?e:null})();(0,a.useLayoutEffect)((()=>{h&&s(h)}),[h]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),g(e),f(e)}),[g,f,i]),tabValues:i}}},36642:(e,t,n)=>{n.d(t,{Z:()=>u});var a=n(27378),r=n(54267),i=n(39798),o=n(33337);function l(e,t,n){let a=e.package?`yarn workspace ${e.package} add `:"yarn add ";return e.dev?a+="--dev ":e.peer&&(a+="--peer "),n&&t&&!e.package&&(a+="-W "),a+=e.dep,a}function s(e,t){let n="pnpm add ";return e.dev?n+="--save-dev ":e.peer&&(n+="--save-peer "),e.package?n+=`--filter ${e.package} `:t&&(n+="-w "),n+=e.dep,n}function u(e){let t=l(e,!1,!0),n=s(e,!1);return e.package||(t+="\n\n# If using workspaces\n",n+="\n\n# If using workspaces\n",t+=l(e,!0,!0),n+=s(e,!0)),a.createElement(o.Z,{groupId:"package-manager",defaultValue:"yarn",values:[{label:"Yarn",value:"yarn"},{label:"Yarn (classic)",value:"yarn1"},{label:"npm",value:"npm"},{label:"pnpm",value:"pnpm"}]},a.createElement(i.Z,{value:"yarn"},a.createElement(r.Z,{language:"shell"},l(e,!1,!1))),a.createElement(i.Z,{value:"yarn1"},a.createElement(r.Z,{language:"shell"},t)),a.createElement(i.Z,{value:"npm"},a.createElement(r.Z,{language:"shell"},function(e){let t="npm install ";return e.dev?t+="--save-dev ":e.peer&&(t+="--save-peer "),e.package&&(t+=`--workspace ${e.package} `),t+=e.dep,t}(e))),a.createElement(i.Z,{value:"pnpm"},a.createElement(r.Z,{language:"shell"},n)))}},32189:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(27378),r=n(83469),i=n(31792);function o(e){let{to:t}=e;return a.createElement("a",{href:t,target:"_blank",className:"float-right inline-block",style:{marginTop:"-3em"}},a.createElement(i.Z,{icon:r.dT$}))}},4496:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>g,frontMatter:()=>l,metadata:()=>u,toc:()=>c});var a=n(25773),r=(n(27378),n(35318)),i=n(36642),o=n(32189);const l={title:"ESLint example",sidebar_label:"ESLint"},s=void 0,u={unversionedId:"guides/examples/eslint",id:"guides/examples/eslint",title:"ESLint example",description:"In this guide, you'll learn how to integrate ESLint into moon.",source:"@site/docs/guides/examples/eslint.mdx",sourceDirName:"guides/examples",slug:"/guides/examples/eslint",permalink:"/docs/guides/examples/eslint",draft:!1,editUrl:"https://github.com/moonrepo/moon/tree/master/website/docs/guides/examples/eslint.mdx",tags:[],version:"current",frontMatter:{title:"ESLint example",sidebar_label:"ESLint"},sidebar:"guides",previous:{title:"Astro",permalink:"/docs/guides/examples/astro"},next:{title:"Jest",permalink:"/docs/guides/examples/jest"}},p={},c=[{value:"Setup",id:"setup",level:2},{value:"TypeScript integration",id:"typescript-integration",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Root-level",id:"root-level",level:3},{value:"Project-level",id:"project-level",level:3},{value:"Sharing",id:"sharing",level:3},{value:"FAQ",id:"faq",level:2},{value:"How to lint a single file or folder?",id:"how-to-lint-a-single-file-or-folder",level:3},{value:"Should we use <code>overrides</code>?",id:"should-we-use-overrides",level:3}],d={toc:c};function g(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(o.Z,{to:"https://github.com/moonrepo/examples/blob/master/.moon/tasks/node.yml#L59",mdxType:"HeadingApiLink"}),(0,r.kt)("p",null,"In this guide, you'll learn how to integrate ",(0,r.kt)("a",{parentName:"p",href:"https://eslint.org/"},"ESLint")," into moon."),(0,r.kt)("p",null,"Begin by installing ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint")," and any plugins in your root. We suggest using the same version across\nthe entire repository."),(0,r.kt)(i.Z,{dep:"eslint eslint-config-moon",dev:!0,mdxType:"AddDepsTabs"}),(0,r.kt)("h2",{id:"setup"},"Setup"),(0,r.kt)("p",null,"Since linting is a universal workflow, add a ",(0,r.kt)("inlineCode",{parentName:"p"},"lint")," task to\n",(0,r.kt)("a",{parentName:"p",href:"../../config/tasks"},(0,r.kt)("inlineCode",{parentName:"a"},".moon/tasks/node.yml"))," with the following parameters."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".moon/tasks/node.yml"',title:'".moon/tasks/node.yml"'},"tasks:\n    lint:\n        command:\n            - 'eslint'\n            # Support other extensions\n            - '--ext'\n            - '.js,.jsx,.ts,.tsx'\n            # Always fix and run extra checks\n            - '--fix'\n            - '--report-unused-disable-directives'\n            # Dont fail if a project has nothing to lint\n            - '--no-error-on-unmatched-pattern'\n            # Do fail if we encounter a fatal error\n            - '--exit-on-fatal-error'\n            # Only 1 ignore file is supported, so use the root\n            - '--ignore-path'\n            - '@in(4)'\n            # Run in current dir\n            - '.'\n        inputs:\n            # Source and test files\n            - 'src/**/*'\n            - 'tests/**/*'\n            # Other config files\n            - '*.config.*'\n            # Project configs, any format, any depth\n            - '**/.eslintrc.*'\n            # Root configs, any format\n            - '/.eslintignore'\n            - '/.eslintrc.*'\n")),(0,r.kt)("p",null,"Projects can extend this task and provide additional parameters if need be, for example."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="<project>/moon.yml"',title:'"<project>/moon.yml"'},"tasks:\n    lint:\n        args:\n            # Enable caching for this project\n            - '--cache'\n")),(0,r.kt)("h3",{id:"typescript-integration"},"TypeScript integration"),(0,r.kt)("p",null,"If you're using the ",(0,r.kt)("a",{parentName:"p",href:"https://typescript-eslint.io"},(0,r.kt)("inlineCode",{parentName:"a"},"@typescript-eslint"))," packages, and want to\nenable type-safety based lint rules, we suggest something similar to the official\n",(0,r.kt)("a",{parentName:"p",href:"https://typescript-eslint.io/docs/linting/monorepo"},"monorepo configuration"),"."),(0,r.kt)("p",null,"Create a ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.eslint.json")," in your repository root, extend your shared compiler options (we use\n",(0,r.kt)("a",{parentName:"p",href:"./typescript"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.options.json")),"), and include all your project files."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="tsconfig.eslint.json"',title:'"tsconfig.eslint.json"'},'{\n  "extends": "./tsconfig.options.json",\n  "compilerOptions": {\n    "emitDeclarationOnly": false,\n    "noEmit": true\n  },\n  "include": ["apps/**/*", "packages/**/*"]\n}\n')),(0,r.kt)("p",null,"Append the following inputs to your ",(0,r.kt)("inlineCode",{parentName:"p"},"lint")," task."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title=".moon/tasks/node.yml"',title:'".moon/tasks/node.yml"'},"tasks:\n    lint:\n        # ...\n        inputs:\n            # TypeScript support\n            - 'types/**/*'\n            - 'tsconfig.json'\n            - '/tsconfig.eslint.json'\n            - '/tsconfig.options.json'\n")),(0,r.kt)("p",null,"And lastly, add ",(0,r.kt)("inlineCode",{parentName:"p"},"parserOptions")," to your ",(0,r.kt)("a",{parentName:"p",href:"#root-level"},"root-level config"),"."),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("h3",{id:"root-level"},"Root-level"),(0,r.kt)("p",null,"The root-level ESLint config is ",(0,r.kt)("em",{parentName:"p"},"required"),", as ESLint traverses upwards from each file to find\nconfigurations, and this denotes the stopping point. It's also used to define rules for the ",(0,r.kt)("em",{parentName:"p"},"entire"),"\nrepository."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title=".eslintrc.js"',title:'".eslintrc.js"'},"module.exports = {\n  root: true, // Required!\n  extends: ['moon'],\n  rules: {\n    'no-console': 'error',\n  },\n\n  // TypeScript support\n  parser: '@typescript-eslint/parser',\n  parserOptions: {\n    project: 'tsconfig.eslint.json',\n    tsconfigRootDir: __dirname,\n  },\n};\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintignore")," file must also be defined at the root, as\n",(0,r.kt)("a",{parentName:"p",href:"https://eslint.org/docs/user-guide/configuring/ignoring-code#the-eslintignore-file"},"only 1 ignore file"),"\ncan exist in a repository. We ensure this ignore file is used by passing ",(0,r.kt)("inlineCode",{parentName:"p"},"--ignore-path")," above."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title=".eslintignore"',title:'".eslintignore"'},"node_modules/\n*.min.js\n*.map\n*.snap\n")),(0,r.kt)("h3",{id:"project-level"},"Project-level"),(0,r.kt)("p",null,"A project-level ESLint config can be utilized by creating a ",(0,r.kt)("inlineCode",{parentName:"p"},".eslintrc.<json|js|cjs|yml>")," in the\nproject root. This is optional, but necessary when defining rules and ignore patterns unique to the\nproject."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="<project>/.eslintrc.js"',title:'"<project>/.eslintrc.js"'},"module.exports = {\n  // Patterns to ignore (alongside the root .eslintignore)\n  ignorePatterns: ['build', 'lib'],\n  // Project specific rules\n  rules: {\n    'no-console': 'off',\n  },\n};\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The\n",(0,r.kt)("a",{parentName:"p",href:"https://eslint.org/docs/user-guide/configuring/configuration-files#extending-configuration-files"},(0,r.kt)("inlineCode",{parentName:"a"},"extends")),"\nsetting should ",(0,r.kt)("strong",{parentName:"p"},"not")," extend the root-level config, as ESLint will automatically merge configs\nwhile traversing upwards!")),(0,r.kt)("h3",{id:"sharing"},"Sharing"),(0,r.kt)("p",null,"To share configuration across projects, you have 3 options:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Define settings in the ",(0,r.kt)("a",{parentName:"li",href:"#root-level"},"root-level config"),". This only applies to the parent\nrepository."),(0,r.kt)("li",{parentName:"ul"},"Create and publish an\n",(0,r.kt)("a",{parentName:"li",href:"https://eslint.org/docs/developer-guide/shareable-configs#using-a-shareable-config"},(0,r.kt)("inlineCode",{parentName:"a"},"eslint-config")),"\nor ",(0,r.kt)("a",{parentName:"li",href:"https://eslint.org/docs/developer-guide/working-with-plugins"},(0,r.kt)("inlineCode",{parentName:"a"},"eslint-plugin"))," npm package.\nThis can be used in any repository."),(0,r.kt)("li",{parentName:"ul"},"A combination of 1 and 2.")),(0,r.kt)("p",null,"For options 2 and 3, if you're utilizing package workspaces, create a local package with the\nfollowing content."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="packages/eslint-config-company/index.js"',title:'"packages/eslint-config-company/index.js"'},"module.exports = {\n  extends: ['airbnb'],\n};\n")),(0,r.kt)("p",null,"Within your root-level ESLint config, you can extend this package to inherit the settings."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title=".eslintrc.js"',title:'".eslintrc.js"'},"module.exports = {\n  extends: 'eslint-config-company',\n};\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"When using this approach, the package must be built and symlinked into ",(0,r.kt)("inlineCode",{parentName:"p"},"node_modules")," ",(0,r.kt)("em",{parentName:"p"},"before")," the\nlinter will run correctly. Take this into account when going down this path!")),(0,r.kt)("h2",{id:"faq"},"FAQ"),(0,r.kt)("h3",{id:"how-to-lint-a-single-file-or-folder"},"How to lint a single file or folder?"),(0,r.kt)("p",null,"Unfortunately, this isn't currently possible, as the ",(0,r.kt)("inlineCode",{parentName:"p"},"eslint")," binary itself requires a file or\nfolder path to operate on, and in the task above we pass ",(0,r.kt)("inlineCode",{parentName:"p"},".")," (current directory). If this was not\npassed, then nothing would be linted."),(0,r.kt)("p",null,"This has the unintended side-effect of not being able to filter down lintable targets by passing\narbitrary file paths. This is something we hope to resolve in the future."),(0,r.kt)("p",null,"To work around this limitation, you can create another lint task."),(0,r.kt)("h3",{id:"should-we-use-overrides"},"Should we use ",(0,r.kt)("inlineCode",{parentName:"h3"},"overrides"),"?"),(0,r.kt)("p",null,"Projects should define their own rules using an ESLint config in their project root. However, if you\nwant to avoid touching many ESLint configs (think migrations), then\n",(0,r.kt)("a",{parentName:"p",href:"https://eslint.org/docs/user-guide/configuring/configuration-files#configuration-based-on-glob-patterns"},"overrides in the root"),"\nare a viable option. Otherwise, we highly encourage project-level configs."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title=".eslintrc.js"',title:'".eslintrc.js"'},"module.exports = {\n  // ...\n  overrides: [\n    // Only apply to apps \"foo\" and \"bar\", but not others\n    {\n      files: ['apps/foo/**/*', 'apps/bar/**/*'],\n      rules: {\n        'no-magic-numbers': 'off',\n      },\n    },\n  ],\n};\n")))}g.isMDXComponent=!0}}]);