"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[67619],{35318:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(27378);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(n),g=o,h=c["".concat(s,".").concat(g)]||c[g]||m[g]||a;return n?r.createElement(h,l(l({ref:t},u),{},{components:n})):r.createElement(h,l({ref:t},u))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=c;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var p=2;p<a;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},67013:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=n(25773),o=(n(27378),n(35318));const a={slug:"proto-v0.14",title:"proto v0.14 - Node.js and Rust now powered by WASM plugins",authors:["milesj"],tags:["proto","wasm","plugin"]},l=void 0,i={permalink:"/blog/proto-v0.14",editUrl:"https://github.com/moonrepo/moon/tree/master/website/blog/2023-08-11_proto-v0.14.mdx",source:"@site/blog/2023-08-11_proto-v0.14.mdx",title:"proto v0.14 - Node.js and Rust now powered by WASM plugins",description:"With this release, we've finished our migration to a WASM based plugin architecture.",date:"2023-08-11T00:00:00.000Z",formattedDate:"August 11, 2023",tags:[{label:"proto",permalink:"/blog/tags/proto"},{label:"wasm",permalink:"/blog/tags/wasm"},{label:"plugin",permalink:"/blog/tags/plugin"}],readingTime:2,hasTruncateMarker:!0,authors:[{name:"Miles Johnson",title:"Founder, developer",url:"https://github.com/milesj",imageURL:"/img/authors/miles.jpg",key:"milesj"}],frontMatter:{slug:"proto-v0.14",title:"proto v0.14 - Node.js and Rust now powered by WASM plugins",authors:["milesj"],tags:["proto","wasm","plugin"]},prevItem:{title:"moon v1.12 - Task improvements: extending, interactive, and more",permalink:"/blog/moon-v1.12"},nextItem:{title:"moon v1.11 - Next-generation project graph",permalink:"/blog/moon-v1.11"}},s={authorsImageUrls:[void 0]},p=[{value:"Full migration to WASM",id:"full-migration-to-wasm",level:2},{value:"Breaking changes for TOML plugins",id:"breaking-changes-for-toml-plugins",level:2},{value:"Other changes",id:"other-changes",level:2}],u={toc:p};function m(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"With this release, we've finished our migration to a WASM based plugin architecture."),(0,o.kt)("h2",{id:"full-migration-to-wasm"},"Full migration to WASM"),(0,o.kt)("p",null,"In ",(0,o.kt)("a",{parentName:"p",href:"./proto-v0.13"},"our last release"),", we migrated the Bun, Deno, and Go plugins to WASM. In this\nrelease, we're excited to announce that we have completed our WASM migration by also converting\nNode.js (and npm, etc) and Rust to WASM plugins. We've also updated our TOML plugin layer to use\nWASM under the hood."),(0,o.kt)("p",null,"With this, 100% of our tools are now powered by WASM, and the APIs are stable enough for you, the\nconsumers, to build your own plugins! We have plans for additional APIs in the next release,\nprimarily installing and uninstall globals, and a hooks system, so look forward to that! To learn\nmore about our official plugins, check out the their repositories!"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/bun-plugin"},"Bun")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/deno-plugin"},"Deno")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/go-plugin"},"Go")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/node-plugin"},"Node")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/rust-plugin"},"Rust")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/moonrepo/schema-plugin"},"Schema"))),(0,o.kt)("p",null,"This release may seem light, but we\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/moonrepo/proto/pull/161"},"rewrote the entire core")," from the ground up to support\na pure plugin based architecture. This was a lot of work, but our implementation is far easier to\nwork with, and more robust. As part of this process, we improved version and range handling, archive\nunpacking, and much more!"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Because of the rewrite, we may have introduced a few bugs. Please report any issues!")),(0,o.kt)("h2",{id:"breaking-changes-for-toml-plugins"},"Breaking changes for TOML plugins"),(0,o.kt)("p",null,"In preparation for the next release, and as clean up during the rewrite, we've made a few breaking\nchanges to the TOML schema, primarily around global handling. To start, this old code:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-toml"},'[install]\nglobals-dir = ["$PROTOSTAR_HOME/bin", "$HOME/.protostar/bin"]\nglobal-args = ["install", "--force", "{dependency}"]\n')),(0,o.kt)("p",null,"Can now be rewritten as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-toml"},'[globals]\nlookup-dirs = ["$PROTOSTAR_HOME/bin", "$HOME/.protostar/bin"]\ninstall-args = ["install", "--force", "{dependency}"]\n')),(0,o.kt)("p",null,"And lastly, the ",(0,o.kt)("inlineCode",{parentName:"p"},"install.unpack")," setting has been removed. We believe our installation layer is\nsmart enough to unpack or move files automatically."),(0,o.kt)("h2",{id:"other-changes"},"Other changes"),(0,o.kt)("p",null,"View the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/moonrepo/proto/releases/tag/v0.14.0"},"official release")," for a full list\nof changes."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Versions defined in ",(0,o.kt)("inlineCode",{parentName:"li"},".prototools")," must be fully-qualified semantic versions. Partial versions\n(missing patch or minor) are no longer supported. This may change in the future based on feedback."),(0,o.kt)("li",{parentName:"ul"},"Tool and plugin names must now be in kebab-case."),(0,o.kt)("li",{parentName:"ul"},"Node",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Yarn 2+ is now installed using ",(0,o.kt)("inlineCode",{parentName:"li"},"@yarnpkg/cli-dist"),". We no longer downgrade to the latest v1."),(0,o.kt)("li",{parentName:"ul"},"Will no longer detect a version from ",(0,o.kt)("inlineCode",{parentName:"li"},"engines")," in ",(0,o.kt)("inlineCode",{parentName:"li"},"package.json"),"."))),(0,o.kt)("li",{parentName:"ul"},"Rust",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Will now detect a version/channel from ",(0,o.kt)("inlineCode",{parentName:"li"},"rust-toolchain.toml")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"rust-toolchain"),".")))))}m.isMDXComponent=!0}}]);